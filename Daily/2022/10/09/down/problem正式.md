# <center>冲刺 NOIP2022 模拟试题</center>

#### <center>时间：8:00-12:00</center>

### **<center>（请选手务必仔细阅读本页内容）</center>**

|     题目名称     | 哼串计数 |  金银变换   |  枝江旧事  | 膜皮圣经 |
| :--------------: | :------: | :---------: | :--------: | :------: |
|     题目类型     |  传统型  |   传统型    |   传统型   |  传统型  |
|       目录       |   heng   |   yinrier   |   zjiang   |   pmyl   |
|   可执行文件名   |   heng   |   yinrier   |   zjiang   |   pmyl   |
|    输入文件名    | heng.in  | yinrier.in  | zjiang.in  | pmyl.in  |
|    输出文件名    | heng.out | yinrier.out | zjiang.out | pmyl.out |
|  每个测试点时限  | $2.0$ 秒 |  $1.0$ 秒   |  $1.0$ 秒  | $2.0$ 秒 |
|     内存限制     |   1 GB   |   512 MB    |   512 MB   | 1024 MB  |
|    测试点数目    |    20    |     25      |     20     |    20    |
|  测试点是否等分  |    是    |     是      |     是     |    是    |
| 提交源程序文件名 | heng.cpp | yinrier.cpp | zjiang.cpp | pmyl.cpp |

**编译选项**：`-lm -O2 -std=c++14`

### 注意事项

1. 文件名（程序名和输入输出文件名）必须使用英文小写。 
2. C++ 中函数 `main()` 的返回值类型必须是 `int`，程序正常结束时的返回值必须是 $0$。 
3. 若无特殊说明，结果比较方式为忽略行末空格、文末回车后的全文比较。
4. 若无特殊说明，输入文件与输出文件中同一行的相邻整数均使用一个空格分隔。
5. **部分题目的【题目描述】末尾有简要题意。**
6. **部分题目的输入输出量较大，建议使用较快的输入输出方式。**
7. 题面经过删改，若有不通顺实属正常。一切请以简要题意为准。
8. 题目较为简单，AK 后请不要大声喧哗，闷声大發财。



<div style="page-break-after: always;"></div>


### <center>哼串计数（heng）</center>

#### 【题目描述】

​		这是一个发生在元冶和李天硕认识伊始的故事。

​		最近，元冶发现李天硕总是发出一些意义不明的声音。为了了解自己的同伴，元冶尝试录下了他的声音，经过银里叶变换（迫真）后，得到了一个字符串。字符串里只有大小写字母和数字，即 $\texttt{a} \sim \texttt{z}$、$\texttt{A} \sim \texttt{Z}$ 以及 $\texttt{0} \sim \texttt{9}$，没有恶臭的不可见字符。

​		可惜银里叶变换是迫真变换，并不能很好地去除周围环境的杂音。但所幸，现在元冶已经发现这段音频的录制时间是李天硕被一转攻势的时候。现在的李天硕只能在这个时段发出“哼，哼，啊啊啊啊啊啊嗷”的声音，而这段声音经过银里叶变换后恰好就是 $\texttt{hghgau}$，不妨称之为哼哼串。不幸的是，银里叶变换会导致音调的丢失，所以 $\texttt{h}$ 可能不是 $\texttt{h}$，$\texttt{g}$ 也可能不是 $\texttt{g}$。但唯一确定的是，变换后不同的字符一定是不同的，相同的字符一定是相同的。

​		现在元冶想要知道，有多少给定字符串的子序列可能是哼哼串？

​		**简要题意：**

​		规定本题中出现的一切字符串下标皆为从 $0$ 开始。

​		定义一个字符串 $C$ 为哼哼串，当且仅当其同时满足如下条件：

​		1. $|C|=6$。
​		2. 对于任意 $0\le i < j< 6$，$C_i=C_j$ 当且仅当 $H_i=H_j$，其中 $H=\texttt{hghgau}$。

​		给定一个字符串 $S$，求其所有子序列中，有多少子序列可能是哼哼串。

​		由于答案可能很大，你只需要输出其对 $998244353$ 取模后的结果。

​		（$A$ 为 $B$ 的子序列，当且仅当从 $B$ 中删除若干字符，并保持剩余字符的相对顺序不变，可以得到 $A$）

#### 【输入格式】

​		**本题单测试点包含多组数据。**

​		第一行一个整数 $T$，表示数据组数。  

​		对于每组数据，输入一行共一个字符串，表示题目给定串 $S$。

#### 【输出格式】

​		输出共 $T$ 行，第 $i$ 行包含一个整数，表示第 $i$ 组数据的答案对 $998244353$ 取模后的结果。

#### 【样例输入 1】

	1
	191980

#### 【样例输出 1】

	1

#### 【样例解释 1】

​		$\texttt{191980}$ 是一个哼哼串，其中 $\texttt{1}$ 对应 $\texttt{hghgau}$ 中的 $\texttt{h}$，$\texttt{9}$ 对应 $\texttt{g}$，$\texttt{8}$ 对应 $\texttt{a}$，$\texttt{0}$ 对应 $\texttt{u}$。

#### 【样例输入 2】

	1
	lylylys

#### 【样例输出 2】

	0

#### 【样例解释 2】

​		$\texttt{lylylys}$ 共有 $7$ 个长度为 $6$ 的子序列：$\texttt{lylyly}$，$\texttt{lylyls}$，$\texttt{lylyys}$，$\texttt{lyllys}$，$\texttt{lyylys}$，$\texttt{llylys}$，$\texttt{ylylys}$，它们都不是哼哼串。

​		以 $C=\texttt{lylyls}$ 为例，$\texttt{h}=H_0 \neq H_4 =\texttt{a}$（$H=\texttt{hghgau}$）而 $C_0=C_4=\texttt{l}$，因此它不是哼哼串。

#### 【样例输入 3】

	2
	guanzhujiaran0dundunjiechan
	JiaRanJinTianChiShenMe

#### 【样例输出 3】

	1065
	773

#### 【数据范围与约定】

​		对于 $100\%$ 的数据，$1\le T\le 10^3$，$1\le |S|,\sum |S|\le 10^6$；$S$ 中只含有大写字母、小写字母和数字共 $62$ 种字符。

​		本题共 $20$ 个测试点，各测试点的具体限制如下：（记 $L=|S|$）

| 测试点编号  | $L$ | $\sum{L}$| 特殊性质
| :------------: | :---------: | :------------: | :--------: |
| $1$ | $=6$ | $\le 6\times 10^3$ | 无 |
|  $2\sim 4$  | $\le 30$ | $\le 6\times 10^3$ | 无 |
|  $5\sim 8$  | $\le 6 \times 10^3$ | $\le 6\times 10^3$ | 无 |
| $9\sim 11$  | $\le 3\times 10^4$ | $\le 3\times 10^4$ | A |
| $12\sim 15$ | $\le 3\times 10^5$ | $\le 3\times 10^5$ | 无 |
| $16$ | $\le 10^6$ | $\le 10^6$ | B |
| $17\sim 20$ | $\le 10^6$ | $\le 10^6$ | 无 |

特殊性质 A：保证 $S$ 中只含有 $\texttt{1}$、$\texttt{4}$、$\texttt{5}$、$\texttt{9}$、$\texttt{8}$、$\texttt{0}$ 共六种字符。

特殊性质 B：对于任意 $0\le i<j<|S|$，若 $S_i=S_j$ 且 $\forall i<k<j,S_k\ne S_i$，则 $j=i+1$。

<div style="page-break-after: always;"></div>




### <center>金银变换（yinrier）</center>

#### 【题目背景】

​		书接上回。

​		在对伴侣的了解过程中，因为使用的银里叶变换太过迫真，元冶吃了不少亏。于是，他撅腚认真钻♂研这一奇妙的变换。

​		最终，在对着示波器调试了 114 个小时后，元冶发现了银里叶变换迫真的秘密：蝶形变换做戳啦！先不说是否完成了 rev，后面的某一步甚至被应用到了所有的 $k$ 上！

​		这点小问题当然难不倒元冶。在原变换的基础上，他稍加修改，就得到了新的变换方式——金里叶变换。可要命的是，他又记错了关键步骤，导致明明是加减的蝶形运算处变成了交换。但好在，他只想判断两个串能否用金里叶变换互相转化而已。由于金里叶变换的形式已经足够简单，元冶请你来帮他解决这个问题。

#### 【题目描述】

​		给定两个整数序列 $A$ 和 $B$，以及一个整数 $k$，判断能否对 $A$ 进行有限次如下操作，使得 $A$ 和 $B$ 相等。

> ​	交换 $A$ 的两个相邻且长度均为 $k$ 的子串。形式化地说，选定整数 $i\;(1 \le i \le n-2k+1)$（其中 $n$ 为 $A$ 的长度），对于 $0 \le j <k$ 中的每个 $j$，交换 $A_{i+j}$ 和 $A_{i+k+j}$。

#### 【输入格式】

​		**本题单测试点包含多组数据。**

​		第一行一个整数 $T$，表示数据组数。  

​		对于每组数据，输入包含三行，具体内容如下：

​		第一行共 $n+1$ 个整数，第一个整数为 $n$，表示 $A$ 的长度，接下来依次为 $A_1,A_2,\cdots,A_n$。

​		第二行共 $m+1$ 个整数，第一个整数为 $m$，表示 $B$ 的长度，接下来依次为 $B_1,B_2,\cdots,B_m$。

​		第三行一个整数 $k$，具体含义参见题目描述。

#### 【输出格式】

​		输出共 $T$ 行，第 $i$ 行包含第 $i$ 组数据的答案。

​		若能使 $A$ 和 $B$ 相等，输出 `YES`，否则输出 `NO`。

#### 【样例输入】

	3
	5 1 2 3 4 5
	5 3 2 5 4 1
	2
	5 1 2 3 4 5
	5 3 2 1 4 5
	2
	5 1 2 3 4 5
	5 5 4 3 2 1
	2
#### 【样例输出】

	YES
	NO
	YES
#### 【样例解释】

​		对于第一组数据，可以通过如下操作使得 $A=B$：
​		1. 选择 $i=1$：$A=(1,2,3,4,5) \to A=(3,4,1,2,5)$。
​		2. 选择 $i=2$：$A=(3,4,1,2,5) \to A=(3,2,5,4,1)$。

​		对于第二组数据，容易发现无论如何操作，都无法使 $A=B$。

​		对于第三组数据，一种可行的操作方式如下：
​		1. 选择 $i=2$：$A=(1,2,3,4,5) \to A=(1,4,5,2,3)$。
​		2. 选择 $i=1$：$A=(1,4,5,2,3) \to A=(5,2,1,4,3)$。
​		3. 选择 $i=2$：$A=(5,2,1,4,3) \to A=(5,4,3,2,1)$。

#### 【数据范围与约定】

​		对于 $100\%$ 的数据，$1 \le T \le 10^3$，$1 \le k \le 5 \times 10^4$，$1 \le n,m \le 10^5$，$\sum{n},\sum{m} \le 10^6$，$0 \le A_i,B_i \le 10^9$。

​		本题共 $25$ 个测试点，各测试点的具体限制如下：

|    测试点编号    |    $T$     |   $n,m$    |         $k$         |     附加限制     |
| :---------: | :--------: | :--------: | :-----------------: | :----------: |
|  $1\sim 3$  | $\le 100$  |  $\le 10$  |       $\le 5$       |      无       |
|  $4\sim 8$  | $\le 100$  | $\le 10^3$ |      $\le 500$      | $A$ 中元素互不相同  |
|     $9$     | $\le 10^3$ | $\le 10^5$ |        $=1$         |      无       |
| $10\sim 11$ | $\le 10^3$ | $\le 10^5$ |       $\le 5$       |      无       |
|    $12$     | $\le 10^3$ | $\le 10^5$ | $\le 5 \times 10^4$ |  $2k \ge n$  |
| $13\sim 14$ | $\le 10^3$ | $\le 10^5$ | $\le 5 \times 10^4$ | $A_i \le 10$ |
| $15\sim 20$ | $\le 10^3$ | $\le 10^5$ | $\le 5 \times 10^4$ | $A$ 中元素互不相同  |
| $21\sim 25$ | $\le 10^3$ | $\le 10^5$ | $\le 5 \times 10^4$ |      无       |

<div style="page-break-after: always;"></div>






### <center>枝江旧事（zjiang）</center>

#### 【题目背景】

​		嘉门。

#### 【题目描述】

​		枝江历 921 年，坐拥 1.6 万余舰的嘉然不满枝江各地各自为政、分裂割据的状况，于 3 月 7 日白袍加身，受封为“圣嘉然”（St. Diana），决定派兵拯救苍生，造福百姓。

​		经过审慎的考虑，圣嘉然将所有的嘉心糖整编为三只队伍，命名为“枝江新军”，希望藉此机会，用自己的受难，赦免所有人们的罪，进而以神秘的力量净化枝江。

​		三只队伍的作用各有不同，但其目的都是一样的：与圣嘉然一起受难，同时展开神秘的法术，以此净化一部分人们。具体的说，三只队伍的法术如下所述：
​		1. 向圣嘉然占卜，得到一个特定的数字 $w$，并将可净化的人数提升到原来的 $w$ 倍。
​		2. 向圣嘉然占卜，得到一个特定的数字 $w$，并将可净化的人数改变为 $w$。
​		3. 向圣嘉然祈祷，在可净化的人数大于等于一个特定素数值 $p$ 的情况下，净化其中的 $p$ 人，i.e. 将可净化的人数减少 $p$。

​		其中队伍 1 和队伍 2 的占卜数字由两个占卜数列分别指定。最初，只有圣嘉然是可净化的。

​		可以发现的是，上述过程有可能会增加可净化的人数，也有可能会减少可净化的人数。但这都是神的旨意，因为所有队伍的行动顺序也是由占卜得来的。但可以保证的是，队伍 1 和队伍 2 所对应的占卜数字都是有限的；同时，在占卜数字出现完后，队伍 1 和 2 不会再出现在行动里。

​		圣嘉然会占卜足够多次，直到可净化的人数稳定于一个值。这个值被称为行动的遗憾值。

​		这似乎是一次完美的行动。可不幸的是，圣嘉然只是一只伪神（idol），其本质还是草莓。作为枝江唯一的真神，你非常清楚这一点。真神和伪神的一大区别就在于你可以操纵占卜的序列，从而控制所有队伍的行动以及数字 $w$ 出现的顺序。可固定的事物总是让人厌倦，无论是排布的顺序还是最终的遗憾值。因此你想知道，有多少遗憾值是无论怎样变换序列的顺序都无法达成的。由于早已不屑于玩这种小孩子过家家的游戏，你想要尽快得出答案。

​		附注：如此对待万物苍生自然是大不敬的行为，但圣嘉然会宽恕你的罪过。嘉门。

​		**简要题意：**

​		给定素数 $p$ 以及 $n$ 个操作，操作有如下两种类型：

​		1. `0 x`：将 $w$ 赋值为 $x$，即令 $w \leftarrow x$。
​		2. `1 x`：将 $w$ 乘上 $x$ 并模 $p$，即令 $w \leftarrow (w \times x) \bmod p$。

​		其中 $w$ 是一个变量，初始值为 $1$。

​		考虑以所有的 $n!$ 种顺序执行这 $n$ 个操作，并在纸上记录下每种顺序最终所得的 $w$，求 $0,1,\cdots,p-1$ 中有多少个数没有出现在纸上。

​		注意，每种顺序的操作的执行是独立的，即每次都会将 $w$ 初始化为 $1$ 后再执行 $n$ 个操作。

#### 【输入格式】

​		**本题单测试点包含多组数据。**

​		第一行一个整数 $T$，表示数据组数。

​		接下来描述 $T$ 组数据，每组数据的格式如下：

​		第一行两个整数 $p$ 和 $n$，分别表示模数和操作数量。

​		第二行至第 $n+1$ 行，每行描述一个操作，具体格式见题目描述。

#### 【输出格式】

​		输出共 $T$ 行，第 $i$ 行包含一个整数，表示第 $i$ 组数据的答案。

#### 【样例输入 1】

	1
	19 3
	0 5
	1 7
	1 17
#### 【样例输出 1】

	15
#### 【样例解释 1】

​		将纸上的数从小到大排序后的结果为：$5,5,6,6,9,16$，故答案为 $19-4=15$。

#### 【样例 2】

​		见附件中的 `zjiang/zjiang2.in` 与 `zjiang/zjiang2.out`，其满足测试点 $7 \sim 10$ 的限制。

#### 【数据范围与约定】

​		对于 $100\%$ 的数据，$1 \le T \le 2$，$1 \le n\le 10^6$，$0 \le x<p$ 且 $x$ 为整数，$2 \le p \le 10^6$ 且 $p$ 为素数。

​		本题共 $20$ 个测试点，各测试点的具体限制如下：（记形如 `1 x` 的操作个数为 $m$）

|    测试点编号    |    $n$     |    $p$     |    附加限制    |
| :---------: | :--------: | :--------: | :--------: |
|  $1\sim 2$  |  $\le 10$  | $\le 10^6$ |     无      |
|  $3\sim 4$  | $\le 10^4$ | $\le 10^6$ | $m \le 12$ |
|  $5\sim 6$  | $\le 10^3$ | $\le 10^4$ |     无      |
| $7\sim 10$  | $\le 10^5$ | $\le 10^5$ |     无      |
| $11\sim 20$ | $\le 10^6$ | $\le 10^6$ |     无      |

#### 【提示】

​		请注意程序的理论时间复杂度和实际运行效率的差异。

<div style="page-break-after: always;"></div>


### <center>膜皮圣经（pmyl）</center>

#### 【题目背景】

> ​		膜拜国际特级大师 Prean 大佬，今天在 CF 首页称您为大夏尊贵的大名，一股 敬佩之油生然而，您在 CF 为国争光，扬我华威名。向您献上最真挚的膜拜
>
> ​		——《膜皮圣经》

#### 【题目描述】

​		在岜怷中学左侧，一条笔直的公路——“hyber 路”旁，居住着 $n$ 户人家。每户人家都有一个生计平衡值，其中第 $i$ 户人家的生计平衡值为 $c_i$。保证所有的生计平衡值 $c$ 构成一个 $1\sim n$ 的排列。

​		$n$ 户人家之间的位置关系由一个长为 $n-1$ 的序列 $d$ 给出。其中，第 $i$ 户人家和第 $i+1$ 户人家之间的距离是 $d_i$（$i<n$）。

​		你是岜怷省的首席传令官（Chief Telecommunication Officer, CTO）。你的上司是皮，岜怷省的省委书记。

​		某天，皮书记有重要指示需要传达。作为全省的 CTO，统筹全局的重任自然落在了你身上。

​		可这也不是什么简单的工作，因为据你所知，就是岜怷中学旁边的那条街就长达 $5e10$ 米，指令的准确传达很成问题。

​		于是你根据皮书记的指示，以《膜皮圣经》为蓝本，制定了以下通讯法则：

​		每次通讯包含两个参数 $l,r$ 和四个步骤：
​		1. 称您大名：皮书记指定一个区间 $[l,r]$ 上的所有人家。
​		2. 油生然而：选择 $p\in [l,r]$ 使得 $\forall i\in [l,r],c_p\le c_i$。简言之，选择生计平衡值最小的人家。
​		3. 扬我威名：第 $p$ 户人从其位置开始，选择一个行走方案，向所有 $[l,r]$ 中的人宣布指令（即覆盖所有 $[l,r]$ 中的点至少一次），并保证行走距离最短，记这个距离为 $w$。注意 $p$ 并不需要最终回到起点。
​		4. 献上膜拜：你向第 $p$ 户人家支付 $c_p\times w$ 的费用。

​		现在皮书记会问您一些问题，每次问题形如一个二元组 $(L,R)$。你需要对于所有的满足 $L\le l\le r\le R$ 的 $l,r$，求出若以其作为通讯参数，支付费用的最大值。

---

​		**简要题意**：

​		给定长度为 $n$ 的排列 $c$ 和长度为 $n-1$ 的正整数序列 $d$（下标从 $1$ 开始）。

​		对于区间 $[l,r](1 \le l \le  r \le n)$， 设 $\min\{c_l,c_{l+1},\cdots,c_r\}=c_k(l \le k \le r)$，定义其权值为：

$$
c_k \times (\sum_{i=l}^{r-1}d_i+\min\{\sum_{i=l}^{k-1}d_i,\sum_{i=k}^{r-1}d_i\})
$$
​		$q$ 次询问，每次给定 $L,R$，求满足 $L \le l \le r \le R$ 的所有区间 $[l,r]$ 的权值最大值。

#### 【输入格式】

​		输入共 $q+4$ 行。

​		第一行一个整数 $n$，表示人家的数量。

​		第二行 $n$ 个整数，表示排列 $c$。

​		第三行 $n-1$ 个整数，表示序列 $d$。

​		第四行一个整数 $q$，表示询问的数量。

​		第五行至第 $q+4$ 行，每行两个整数 $L,R$，表示一次询问。

#### 【输出格式】

​		输出共 $q$ 行，每行一个整数，表示每组询问的答案。

#### 【样例输入 1】

```
5
4 1 5 2 3
2 8 4 2
4
3 5
1 2
2 4
1 3
```

#### 【样例输出 1】

```
16
2
12
12
```

#### 【样例 2】

​		见附件中的 `pmyl/pmyl2.in` 与 `pmyl/pmyl2.out`，其满足测试点 $7 \sim 12$ 的限制。

#### 【数据范围与约定】

​		对于 $100\%$ 的数据，$1\le n\le 5\times 10^5$，$1 \le c_i \le n$ 且 $c_i$ 互不相同，$1\le d_i\le 10^5$，$1\le q\le 10^6$，$1\le L\le R\le n$。

​		本题共 $20$ 个测试点，各测试点的具体限制如下：

| 测试点编号  |        $n$         |    $q$     |   特殊性质   |
| :---------: | :----------------: | :--------: | :----------: |
|  $1\sim 2$  |     $\le 500$      | $\le 500$  |   $\times$   |
|  $3\sim 4$  | $\le 5\times 10^3$ | $\le 10^6$ |   $\times$   |
|  $5\sim 6$  | $\le 5\times 10^5$ | $\le 100$  |   $\times$   |
| $7\sim 12$  |     $\le 10^5$     | $\le 10^5$ | $\checkmark$ |
| $13\sim 20$ | $\le 5\times 10^5$ | $\le 10^6$ |   $\times$   |

​		特殊性质：保证对于 $\forall i\in [1,n]$，$c_i=i$。